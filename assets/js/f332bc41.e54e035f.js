"use strict";(self.webpackChunkicicle_docs=self.webpackChunkicicle_docs||[]).push([[4001],{95033:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>d,frontMatter:()=>r,metadata:()=>n,toc:()=>m});const n=JSON.parse('{"id":"icicle/primitives/msm","title":"MSM - Multi Scalar Multiplication","description":"Overview","source":"@site/versioned_docs/version-3.0.0/icicle/primitives/msm.md","sourceDirName":"icicle/primitives","slug":"/icicle/primitives/msm","permalink":"/3.0.0/icicle/primitives/msm","draft":false,"unlisted":false,"editUrl":"https://github.com/ingonyama-zk/icicle/tree/main/docs/versioned_docs/version-3.0.0/icicle/primitives/msm.md","tags":[],"version":"3.0.0","lastUpdatedBy":"Elan","lastUpdatedAt":1743510995000,"frontMatter":{},"sidebar":"GettingStartedSidebar","previous":{"title":"ICICLE Compute APIs","permalink":"/3.0.0/icicle/primitives/overview"},"next":{"title":"NTT / ECNTT","permalink":"/3.0.0/icicle/primitives/ntt"}}');var i=a(74848),l=a(28453);const r={},t="MSM - Multi Scalar Multiplication",c={},m=[{value:"Overview",id:"overview",level:2},{value:"C++ API",id:"c-api",level:2},{value:"<code>MSMConfig</code> Struct",id:"msmconfig-struct",level:3},{value:"Default Configuration",id:"default-configuration",level:4},{value:"<code>msm</code> Function",id:"msm-function",level:3},{value:"Batched MSM",id:"batched-msm",level:3},{value:"G2 MSM",id:"g2-msm",level:3},{value:"Precompution",id:"precompution",level:3},{value:"What It Does:",id:"what-it-does",level:4},{value:"When to Use:",id:"when-to-use",level:4},{value:"Rust and Go bindings",id:"rust-and-go-bindings",level:2},{value:"CUDA backend MSM",id:"cuda-backend-msm",level:2},{value:"Algorithm description",id:"algorithm-description",level:3},{value:"Configuring CUDA msm",id:"configuring-cuda-msm",level:2},{value:"Choosing optimal parameters",id:"choosing-optimal-parameters",level:3},{value:"Memory usage estimation",id:"memory-usage-estimation",level:2},{value:"Example parameters",id:"example-parameters",level:2}];function h(s){const e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",munderover:"munderover",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"msm---multi-scalar-multiplication",children:"MSM - Multi Scalar Multiplication"})}),"\n",(0,i.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(e.p,{children:"Multi-Scalar Multiplication (MSM) is a fundamental operation in elliptic curve cryptography and zero-knowledge proofs. It is defined as:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mi,{children:"S"}),(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.munderover,{children:[(0,i.jsx)(e.mo,{children:"\u2211"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"j"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"n"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mn,{children:"1"})]})]}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"j"})]}),(0,i.jsx)(e.mo,{children:"\u22c5"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mi,{children:"j"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"MSM(a, G) = \\sum_{j=0}^{n-1} a_j \\cdot G_j"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"MSM"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"3.2149em",verticalAlign:"-1.4138em"}}),(0,i.jsx)(e.span,{className:"mop op-limits",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.8011em"},children:[(0,i.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"}),(0,i.jsx)(e.span,{className:"mrel mtight",children:"="}),(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{children:(0,i.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,i.jsxs)(e.span,{style:{top:"-4.3em",marginLeft:"0em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"}),(0,i.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"1.4138em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})}),"\n",(0,i.jsx)(e.p,{children:"Where:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mi,{children:"j"})]}),(0,i.jsx)(e.mo,{children:"\u2208"}),(0,i.jsx)(e.mi,{children:"G"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"G_j \\in G"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2208"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"})]})]})]})," are points from an elliptic curve group."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mo,{children:"\u2026"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"n"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"a_0, \\ldots, a_n"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"minner",children:"\u2026"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," are scalars."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mi,{children:"S"}),(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"G"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2208"}),(0,i.jsx)(e.mi,{children:"G"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"MSM(a, G) \\in G"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"MSM"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2208"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"G"})]})]})]})," is the result, a single elliptic curve point."]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"MSM is inherently parallelizable, making it a critical operation for optimizing performance in cryptographic protocols like zk-SNARKs. Accelerating MSM can significantly reduce the time required for proof generation."}),"\n",(0,i.jsxs)(e.p,{children:["Accelerating MSM is crucial to a ZK protocol's performance due to the ",(0,i.jsx)(e.a,{href:"https://hackmd.io/@0xMonia/SkQ6-oRz3#Hardware-acceleration-in-action",children:"large percent of run time"})," they take when generating proofs.\nYou can learn more about how MSMs work from this ",(0,i.jsx)(e.a,{href:"https://www.youtube.com/watch?v=Bl5mQA7UL2I",children:"video"})," and from our resource list on ",(0,i.jsx)(e.a,{href:"https://www.ingonyama.com/ingopedia/msm",children:"Ingopedia"}),"."]}),"\n",(0,i.jsx)(e.h2,{id:"c-api",children:"C++ API"}),"\n",(0,i.jsxs)(e.h3,{id:"msmconfig-struct",children:[(0,i.jsx)(e.code,{children:"MSMConfig"})," Struct"]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.code,{children:"MSMConfig"})," struct configures the MSM operation. It allows customization of parameters like the number of precomputed points, the window bitsize (",(0,i.jsx)(e.code,{children:"c"}),"), and memory management. Here's the configuration structure:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"struct MSMConfig {\n  icicleStreamHandle stream;\n  int precompute_factor;\n  int c;\n  int bitsize;\n  int batch_size;\n  bool are_points_shared_in_batch;\n  bool are_scalars_on_device;\n  bool are_scalars_montgomery_form;\n  bool are_points_on_device;\n  bool are_points_montgomery_form;\n  bool are_results_on_device;\n  bool is_async;\n  ConfigExtension* ext;\n};\n"})}),"\n",(0,i.jsx)(e.h4,{id:"default-configuration",children:"Default Configuration"}),"\n",(0,i.jsxs)(e.p,{children:["You can obtain a default ",(0,i.jsx)(e.code,{children:"MSMConfig"})," using:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"  static MSMConfig default_msm_config()\n  {\n    MSMConfig config = {\n      nullptr, // stream\n      1,       // precompute_factor\n      0,       // c\n      0,       // bitsize\n      1,       // batch_size\n      true,    // are_points_shared_in_batch\n      false,   // are_scalars_on_device\n      false,   // are_scalars_montgomery_form\n      false,   // are_points_on_device\n      false,   // are_points_montgomery_form\n      false,   // are_results_on_device\n      false,   // is_async\n      nullptr, // ext\n    };\n    return config;\n  }\n"})}),"\n",(0,i.jsxs)(e.h3,{id:"msm-function",children:[(0,i.jsx)(e.code,{children:"msm"})," Function"]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.code,{children:"msm"})," function computes the MSM operation:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"template <typename S, typename A, typename P>\neIcicleError msm(const S* scalars, const A* bases, int msm_size, const MSMConfig& config, P* results);\n"})}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"The API is template and can work with all ICICLE curves (if corresponding lib is linked), including G2 groups."})}),"\n",(0,i.jsx)(e.h3,{id:"batched-msm",children:"Batched MSM"}),"\n",(0,i.jsx)(e.p,{children:"The MSM supports batch mode - running multiple MSMs in parallel. It's always better to use the batch mode instead of running single msms in serial as long as there is enough memory available. We support running a batch of MSMs that share the same points as well as a batch of MSMs that use different points."}),"\n",(0,i.jsxs)(e.p,{children:["Config fields ",(0,i.jsx)(e.code,{children:"are_points_shared_in_batch"})," and ",(0,i.jsx)(e.code,{children:"batch_size"})," are used to configure msm for batch mode."]}),"\n",(0,i.jsx)(e.h3,{id:"g2-msm",children:"G2 MSM"}),"\n",(0,i.jsxs)(e.p,{children:["for G2 MSM, use the ",(0,i.jsx)(e.a,{href:"#msm-function",children:"same msm api"})," with the G2 types."]}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"Supported curves have types for both G1 and G2."})}),"\n",(0,i.jsx)(e.h3,{id:"precompution",children:"Precompution"}),"\n",(0,i.jsx)(e.h4,{id:"what-it-does",children:"What It Does:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"The function computes a set of additional points derived from the original base points. These precomputed points are stored and later reused during the MSM computation."}),"\n",(0,i.jsx)(e.li,{children:"Purpose: By precomputing and storing these points, the MSM operation can reduce the number of operations needed at runtime, which can significantly speed up the calculation."}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"when-to-use",children:"When to Use:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Memory vs. Speed Trade-off: Precomputation increases the memory footprint because additional points are stored, but it reduces the computational effort during MSM, making the process faster."}),"\n",(0,i.jsx)(e.li,{children:"Best for Repeated Use: It\u2019s especially beneficial when the same set of base points is used multiple times in different MSM operations."}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"template <typename A>\neIcicleError msm_precompute_bases(const A* input_bases, int bases_size, const MSMConfig& config, A* output_bases);\n"})}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:["User is allocating the ",(0,i.jsx)(e.code,{children:"output_bases"})," (on host or device memory) and later use it as bases when calling msm."]})}),"\n",(0,i.jsx)(e.h2,{id:"rust-and-go-bindings",children:"Rust and Go bindings"}),"\n",(0,i.jsx)(e.p,{children:"The Rust and Go bindings provide equivalent functionality for their respective environments. Refer to their documentation for details on usage."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/3.0.0/icicle/golang-bindings/msm",children:"Golang"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/3.0.0/icicle/rust-bindings/msm",children:"Rust"})}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"cuda-backend-msm",children:"CUDA backend MSM"}),"\n",(0,i.jsx)(e.p,{children:"This section describes the CUDA msm implementation and how to customize it (optional)."}),"\n",(0,i.jsx)(e.h3,{id:"algorithm-description",children:"Algorithm description"}),"\n",(0,i.jsx)(e.p,{children:"We follow the bucket method algorithm. The GPU implementation consists of four phases:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Preparation phase - The scalars are split into smaller scalars of ",(0,i.jsx)(e.code,{children:"c"})," bits each. These are the bucket indices. The points are grouped according to their corresponding bucket index and the buckets are sorted by size."]}),"\n",(0,i.jsxs)(e.li,{children:["Accumulation phase - Each bucket accumulates all of its points using a single thread. More than one thread is assigned to large buckets, in proportion to their size. A bucket is considered large if its size is above the large bucket threshold that is determined by the ",(0,i.jsx)(e.code,{children:"large_bucket_factor"})," parameter. The large bucket threshold is the expected average bucket size times the ",(0,i.jsx)(e.code,{children:"large_bucket_factor"})," parameter."]}),"\n",(0,i.jsxs)(e.li,{children:["Buckets Reduction phase - bucket results are multiplied by their corresponding bucket number and each bucket module is reduced to a small number of final results. By default, this is done by an iterative algorithm which is highly parallel. Setting ",(0,i.jsx)(e.code,{children:"is_big_triangle"})," to ",(0,i.jsx)(e.code,{children:"true"})," will switch this phase to the running sum algorithm described in the above YouTube talk which is much less parallel."]}),"\n",(0,i.jsx)(e.li,{children:"Final accumulation phase - The final results from the last phase are accumulated using the double-and-add algorithm."}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"configuring-cuda-msm",children:"Configuring CUDA msm"}),"\n",(0,i.jsxs)(e.p,{children:["Use ",(0,i.jsx)(e.code,{children:"ConfigExtension"})," object to pass backend specific configuration.\nCUDA specific msm configuration:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:'ConfigExtension ext;\next.set("large_bucket_factor", 15); \n// use the config-extension in the msm config for the backend to see.\nmsm_config.ext = &ext;\n// call msm\nmsm(..., config,...); // msm backend is reading the config-extension\n'})}),"\n",(0,i.jsx)(e.h3,{id:"choosing-optimal-parameters",children:"Choosing optimal parameters"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"is_big_triangle"})," should be ",(0,i.jsx)(e.code,{children:"false"})," in almost all cases. It might provide better results only for very small MSMs (smaller than 2^8^) with a large batch (larger than 100) but this should be tested per scenario.\nLarge buckets exist in two cases:"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"When the scalar distribution isn't uniform."}),"\n",(0,i.jsxs)(e.li,{children:["When ",(0,i.jsx)(e.code,{children:"c"})," does not divide the scalar bit-size."]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"large_bucket_factor"})," that is equal to 10 yields good results for most cases, but it's best to fine tune this parameter per ",(0,i.jsx)(e.code,{children:"c"})," and per scalar distribution.\nThe two most important parameters for performance are ",(0,i.jsx)(e.code,{children:"c"})," and the ",(0,i.jsx)(e.code,{children:"precompute_factor"}),". They affect the number of EC additions as well as the memory size. When the points are not known in advance we cannot use precomputation. In this case the best ",(0,i.jsx)(e.code,{children:"c"})," value is usually around ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mn,{children:"2"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"S"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"z"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mn,{children:"4"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"log_2(msmSize) - 4"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ze"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"4"})]})]})]}),". However, in most protocols the points are known in advanced and precomputation can be used unless limited by memory. Usually it's best to use maximum precomputation (such that we end up with only a single bucket module) combined we a ",(0,i.jsx)(e.code,{children:"c"})," value around ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mn,{children:"2"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"S"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"z"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"log_2(msmSize) - 1"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ze"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"})]})]})]}),"."]}),"\n",(0,i.jsx)(e.h2,{id:"memory-usage-estimation",children:"Memory usage estimation"}),"\n",(0,i.jsx)(e.p,{children:"The main memory requirements of the MSM are the following:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Scalars - ",(0,i.jsx)(e.code,{children:"sizeof(scalar_t) * msm_size * batch_size"})]}),"\n",(0,i.jsxs)(e.li,{children:["Scalar indices - ",(0,i.jsx)(e.code,{children:"~6 * sizeof(unsigned) * nof_bucket_modules * msm_size * batch_size"})]}),"\n",(0,i.jsxs)(e.li,{children:["Points - ",(0,i.jsx)(e.code,{children:"sizeof(affine_t) * msm_size * precomp_factor * batch_size"})]}),"\n",(0,i.jsxs)(e.li,{children:["Buckets - ",(0,i.jsx)(e.code,{children:"sizeof(projective_t) * nof_bucket_modules * 2^c * batch_size"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["where ",(0,i.jsx)(e.code,{children:"nof_bucket_modules =  ceil(ceil(bitsize / c) / precompute_factor)"})]}),"\n",(0,i.jsx)(e.p,{children:"During the MSM computation first the memory for scalars and scalar indices is allocated, then the indices are freed and points and buckets are allocated. This is why a good estimation for the required memory is the following formula:"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"I"}),(0,i.jsx)(e.mi,{children:"n"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"n"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"b"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"k"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"max(scalars + scalarIndices, scalars + points + buckets)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ma"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"sc"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"rs"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"sc"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"I"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ces"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"sc"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"rs"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.854em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"b"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsx)(e.p,{children:"This gives a good approximation within 10% of the actual required memory for most cases."}),"\n",(0,i.jsx)(e.h2,{id:"example-parameters",children:"Example parameters"}),"\n",(0,i.jsx)(e.p,{children:"Here is a useful table showing optimal parameters for different MSMs. They are optimal for BLS12-377 curve when running on NVIDIA GeForce RTX 3090 Ti. This is the configuration used:"}),"\n",(0,i.jsx)(e.p,{children:"Here are the parameters and the results for the different cases:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"MSM size"}),(0,i.jsx)(e.th,{children:"Batch size"}),(0,i.jsx)(e.th,{children:"Precompute factor"}),(0,i.jsx)(e.th,{children:"c"}),(0,i.jsx)(e.th,{children:"Memory estimation (GB)"}),(0,i.jsx)(e.th,{children:"Actual memory (GB)"}),(0,i.jsx)(e.th,{children:"Single MSM time (ms)"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"10"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"9"}),(0,i.jsx)(e.td,{children:"0.00227"}),(0,i.jsx)(e.td,{children:"0.00277"}),(0,i.jsx)(e.td,{children:"9.2"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"10"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"23"}),(0,i.jsx)(e.td,{children:"11"}),(0,i.jsx)(e.td,{children:"0.00259"}),(0,i.jsx)(e.td,{children:"0.00272"}),(0,i.jsx)(e.td,{children:"1.76"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"10"}),(0,i.jsx)(e.td,{children:"1000"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"7"}),(0,i.jsx)(e.td,{children:"0.94"}),(0,i.jsx)(e.td,{children:"1.09"}),(0,i.jsx)(e.td,{children:"0.051"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"10"}),(0,i.jsx)(e.td,{children:"1000"}),(0,i.jsx)(e.td,{children:"23"}),(0,i.jsx)(e.td,{children:"11"}),(0,i.jsx)(e.td,{children:"2.59"}),(0,i.jsx)(e.td,{children:"2.74"}),(0,i.jsx)(e.td,{children:"0.025"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"11"}),(0,i.jsx)(e.td,{children:"0.011"}),(0,i.jsx)(e.td,{children:"0.019"}),(0,i.jsx)(e.td,{children:"9.9"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"16"}),(0,i.jsx)(e.td,{children:"16"}),(0,i.jsx)(e.td,{children:"0.061"}),(0,i.jsx)(e.td,{children:"0.065"}),(0,i.jsx)(e.td,{children:"2.4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"100"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"11"}),(0,i.jsx)(e.td,{children:"1.91"}),(0,i.jsx)(e.td,{children:"1.92"}),(0,i.jsx)(e.td,{children:"0.84"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"100"}),(0,i.jsx)(e.td,{children:"19"}),(0,i.jsx)(e.td,{children:"14"}),(0,i.jsx)(e.td,{children:"6.32"}),(0,i.jsx)(e.td,{children:"6.61"}),(0,i.jsx)(e.td,{children:"0.56"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"18"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"14"}),(0,i.jsx)(e.td,{children:"0.128"}),(0,i.jsx)(e.td,{children:"0.128"}),(0,i.jsx)(e.td,{children:"14.4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"18"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"17"}),(0,i.jsx)(e.td,{children:"0.40"}),(0,i.jsx)(e.td,{children:"0.42"}),(0,i.jsx)(e.td,{children:"5.9"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"22"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"17"}),(0,i.jsx)(e.td,{children:"1.64"}),(0,i.jsx)(e.td,{children:"1.65"}),(0,i.jsx)(e.td,{children:"68"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"22"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"13"}),(0,i.jsx)(e.td,{children:"21"}),(0,i.jsx)(e.td,{children:"5.67"}),(0,i.jsx)(e.td,{children:"5.94"}),(0,i.jsx)(e.td,{children:"54"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"24"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"18"}),(0,i.jsx)(e.td,{children:"6.58"}),(0,i.jsx)(e.td,{children:"6.61"}),(0,i.jsx)(e.td,{children:"232"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"24"}),(0,i.jsx)(e.td,{children:"1"}),(0,i.jsx)(e.td,{children:"7"}),(0,i.jsx)(e.td,{children:"21"}),(0,i.jsx)(e.td,{children:"12.4"}),(0,i.jsx)(e.td,{children:"13.4"}),(0,i.jsx)(e.td,{children:"199"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"The optimal values can vary per GPU and per curve. It is best to try a few combinations until you get the best results for your specific case."})]})}function d(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}},28453:(s,e,a)=>{a.d(e,{R:()=>r,x:()=>t});var n=a(96540);const i={},l=n.createContext(i);function r(s){const e=n.useContext(l);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function t(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:r(s.components),n.createElement(l.Provider,{value:e},s.children)}}}]);